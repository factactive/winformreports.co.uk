 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "https://www.w3.org/TR/html4/loose.dtd">
<html><!-- InstanceBegin template="/Templates/winformreports_howto.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<!-- InstanceBeginEditable name="doctitle" --> 
<title>WinForm Reports for .NET - HowTo and Support Articles</title>
<!-- InstanceEndEditable --> 
<meta https-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<script language="JavaScript1.2" src="https://www.qarbon.com/viewlet.js"></script>
<!-- InstanceBeginEditable name="head" --><!-- InstanceEndEditable -->
<link href="../wf.css" rel="stylesheet" type="text/css">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tr> 
    <td> 
      <table width="100%" border="0" cellspacing="0" cellpadding="0" background="../title%20background.gif">
        <tr> 
          <td><img src="../winform%20reports%20title.gif" width="292" height="24" alt="Winform Reports for .NET" align="middle"></td>
          <td><img src="../shim.gif" width="1" height="35"></td>
        </tr>
        <tr> 
          <td background="../greydot.gif"><img src="../shim.gif" width="1" height="1"></td>
          <td></td>
        </tr>
      </table>
    </td>
  </tr>
  <tr valign="top"> 
    <td> 
      <table border="0" cellspacing="0" cellpadding="0">
        <tr> 
          <td align="left" valign="top"> 
            <table width="140" border="0" cellspacing="0" cellpadding="0">
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="7"></td>
                <td bgcolor="#DEE7ED"></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="7"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../index.htm">Home</a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<font color="#666666"><a href="../productcomparison.htm">Product Comparison</a></font></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<font color="#666666">Products</font></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../features_pf.htm">PrintForm
                    .NET</a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../features_pc.htm">PrintControls 
                  .NET</a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../features_pa.htm">PrintAdapters
                    .NET</a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../features_pp.htm">PrintPreviewDialog
                    .NET</a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../features_loc.htm">Localizer
                    ASP.NET</a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../features_we.htm">WebExtenders
ASP.NET</a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;Downloads</td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../downloads.htm">Free Trial Versions </a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../Updates/ViewUpdates.aspx">Upgrades</a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../documents.htm">Documents
                    &amp; Papers</a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../purchase.htm">Purchase</a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="index.htm">Support Index</a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../press.htm">Press 
                  Releases </a> </td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../contactus.asp">Contact 
                  Us</a> <a href="../contactus.asp"><img src="../mail.gif" width="15" height="11" border="0" align="absbottom"></a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../privacy.htm">Privacy 
                  Statement</a> </td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td height="19" bgcolor="#F0F4F7">
                  <table width="140" cellpadding= "2" cellspacing="0" border="0" bgcolor="#F0F4F7">
                    <tr bgcolor="#F0F4F7" align="center" valign="top">
                      <td ><img src="../shim.gif" width="4" height="1"></td>
                      <td align="left" >&nbsp;                      </td>
                    </tr>
                  </table>
                </td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">                  <div align="center">&nbsp;<img src="../shim.gif" width="1" height="5" align="top"><br>
                    </div>
                </td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp; </td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="10"></td>
                <td><img src="../shim.gif" width="170" height="10"></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="10"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="10"></td>
                <td><img src="../shim.gif" width="10" height="10"></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="3" height="10"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td> 
                  <div align="center"><a href="https://www.wikipedia.org" target="_blank"><img src="../tmglogo.gif" width="124" height="31" border="0" alt="Go to TMG Development Ltd Website"></a></div>
                </td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td><img src="../shim.gif" width="10" height="20"></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td> 
                  <div align="center"><img src="../MCSD.jpg" width="112" height="53" alt="Microsoft Certified Partner"></div>
                </td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="5"></td>
                <td><img src="../shim.gif" width="10" height="5"></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="5"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
            </table>
          </td>
          <td align="left" valign="top">
		<table width="100%"  border="0" align="left" cellpadding="0" cellspacing="0">
 		 <tr align="left">
		<td><img src="../shim.gif" width="10" height="1"></td>
		<td></td>
		</tr>
		<tr align="left" valign="top">
		<td></td>
		<td>
		<!-- InstanceBeginEditable name="MainArea" -->
		<h3 class="HowToHeading">HowTo: Draw Headers and Footers from Code </h3>
		<p class="HowToPara"><span class="HowToSubHeading">ID: W3298014</span> </p>
		<p class="HowToPara">&nbsp;</p>
		<p class="HowToPara"><span class="HowToSubHeading">Background</span>		    </p>
		<p class="HowToPara">In some situations you may want to draw headers and footers on the printed page manually. PrintForm can do this for you, but if you are using PrintAdapters or PrintControls in isolation, or if you are using PrintChainManager to join the output of more than one of these components into a single print job you will need to add the following code to ensure that header and footer text is drawn on the printed page.</p>
		<p class="HowToSubHeading">Drawing Text Using Graphics.DrawString </p>
		<p class="HowToPara">This code illustrates how to calculate the location for header and footer based on the <strong>PrintPageEventArgs.MarginBounds</strong> rectangle, and then uses the <strong>Graphics.DrawString</strong> method to render the text. Note that this code is for the PrintChainManager, but since all our printing controls including PrintChainManager are derived from the framework's <strong>PrintDocument</strong> class, they all have a <strong>PrintPage</strong> event you can handle to execute this code: </p>
		<p> <span class="codefont">Private Sub PrintChainManager1_PrintPage(ByVal sender As System.Object, ByVal e As System.Drawing.Printing.PrintPageEventArgs) Handles PrintChainManager1.PrintPage<br>
&nbsp;&nbsp;' TODO: if not using PrintChainManager you may need to keep track of the page <br>
&nbsp;&nbsp;' in a member variable. In this case though PrintChainManager does it for us:<br>
&nbsp;&nbsp;Dim pageNumber As Integer = Me.PrintChainManager1.PageNumber</span></p>
		<p><span class="codefont"> &nbsp;&nbsp;' Calculate a location for the header in the top margin space<br>
		  &nbsp;&nbsp;Dim locationHeader As Point = e.MarginBounds.Location<br>
		  &nbsp;&nbsp;locationHeader.Offset(e.MarginBounds.Width / 2 - 30, -15)<br>
		  &nbsp;&nbsp;' Draw the header text using the default Font of the Form<br>
		  &nbsp;&nbsp;e.Graphics.DrawString(&quot;Heading of Page &quot; + pageNumber.ToString(), Me.Font, Brushes.Black, locationHeader.X, locationHeader.Y)<br>
		  &nbsp;&nbsp;' Calculate a location for the fotter in the bottom margin space<br>
		  &nbsp;&nbsp;Dim locationFooter As Point = e.MarginBounds.Location<br>
		  &nbsp;&nbsp;locationFooter.Offset(e.MarginBounds.Width / 2 - 30, e.MarginBounds.Height)<br>
		  &nbsp;&nbsp;' Draw the footer text <br>
		  &nbsp;&nbsp;e.Graphics.DrawString(&quot;Footer of Page &quot; + pageNumber.ToString(), Me.Font, Brushes.Black, locationFooter.X, locationFooter.Y)<br>
		  End Sub</span><br>
		  </p>
		<p class="HowToPara">
		  Last updated 
		  <!-- #BeginDate format:En2 -->30-Mar-2019<!-- #EndDate -->
		</p>
		<!-- InstanceEndEditable -->		</td>
		</tr>
		</table>
  		</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
</body>
<script src="https://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-2162526-1";
urchinTracker();
</script>
<!-- InstanceEnd --></html>
