 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "https://www.w3.org/TR/html4/loose.dtd">
<html><!-- InstanceBegin template="/Templates/winformreports_howto.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<!-- InstanceBeginEditable name="doctitle" --> 
<title>WinForm Reports for .NET - HowTo: Use the PrintForm PrintPageComplete Event to Draw 'Rubber Stamp' Text on Top of the Printout</title>
<!-- InstanceEndEditable --> 
<meta https-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<script language="JavaScript1.2" src="https://www.qarbon.com/viewlet.js"></script>
<!-- InstanceBeginEditable name="head" -->
<!-- InstanceEndEditable -->
<link href="../wf.css" rel="stylesheet" type="text/css">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tr> 
    <td> 
      <table width="100%" border="0" cellspacing="0" cellpadding="0" background="../title%20background.gif">
        <tr> 
          <td><img src="../winform%20reports%20title.gif" width="292" height="24" alt="Winform Reports for .NET" align="middle"></td>
          <td><img src="../shim.gif" width="1" height="35"></td>
        </tr>
        <tr> 
          <td background="../greydot.gif"><img src="../shim.gif" width="1" height="1"></td>
          <td></td>
        </tr>
      </table>
    </td>
  </tr>
  <tr valign="top"> 
    <td> 
      <table border="0" cellspacing="0" cellpadding="0">
        <tr> 
          <td align="left" valign="top"> 
            <table width="140" border="0" cellspacing="0" cellpadding="0">
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="7"></td>
                <td bgcolor="#DEE7ED"></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="7"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../index.htm">Home</a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<font color="#666666"><a href="../productcomparison.htm">Product Comparison</a></font></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<font color="#666666">Products</font></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../features_pf.htm">PrintForm
                    .NET</a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../features_pc.htm">PrintControls 
                  .NET</a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../features_pa.htm">PrintAdapters
                    .NET</a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../features_pp.htm">PrintPreviewDialog
                    .NET</a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../features_loc.htm">Localizer
                    ASP.NET</a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../features_we.htm">WebExtenders
ASP.NET</a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;Downloads</td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../downloads.htm">Free Trial Versions </a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../Updates/ViewUpdates.aspx">Upgrades</a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../documents.htm">Documents
                    &amp; Papers</a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../purchase.htm">Purchase</a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="index.htm">Support Index</a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../press.htm">Press 
                  Releases </a> </td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../contactus.asp">Contact 
                  Us</a> <a href="../contactus.asp"><img src="../mail.gif" width="15" height="11" border="0" align="absbottom"></a></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp;&nbsp;<img src="../bullet.gif" width="6" height="7">&nbsp;<a href="../privacy.htm">Privacy 
                  Statement</a> </td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td height="19" bgcolor="#F0F4F7">
                  <table width="140" cellpadding= "2" cellspacing="0" border="0" bgcolor="#F0F4F7">
                    <tr bgcolor="#F0F4F7" align="center" valign="top">
                      <td ><img src="../shim.gif" width="4" height="1"></td>
                      <td align="left" >&nbsp;                      </td>
                    </tr>
                  </table>
                </td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">                  <div align="center">&nbsp;<img src="../shim.gif" width="1" height="5" align="top"><br>
                    </div>
                </td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td bgcolor="#F0F4F7">&nbsp; </td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="10"></td>
                <td><img src="../shim.gif" width="170" height="10"></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="10"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="10"></td>
                <td><img src="../shim.gif" width="10" height="10"></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="3" height="10"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td> 
                  <div align="center"><a href="https://www.wikipedia.org" target="_blank"><img src="../tmglogo.gif" width="124" height="31" border="0" alt="Go to TMG Development Ltd Website"></a></div>
                </td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td><img src="../shim.gif" width="10" height="20"></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="20"></td>
                <td> 
                  <div align="center"><img src="../MCSD.jpg" width="112" height="53" alt="Microsoft Certified Partner"></div>
                </td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="20"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif"><img src="../shim.gif" width="1" height="5"></td>
                <td><img src="../shim.gif" width="10" height="5"></td>
                <td background="../greydotsh.gif"><img src="../shim.gif" width="1" height="5"></td>
              </tr>
              <tr> 
                <td background="../greydot.gif" colspan="3"><img src="../shim.gif" width="1" height="1"></td>
              </tr>
            </table>
          </td>
          <td align="left" valign="top">
		<table width="100%"  border="0" align="left" cellpadding="0" cellspacing="0">
 		 <tr align="left">
		<td><img src="../shim.gif" width="10" height="1"></td>
		<td></td>
		</tr>
		<tr align="left" valign="top">
		<td></td>
		<td>
		<!-- InstanceBeginEditable name="MainArea" -->
		<p class="HowToHeading">HowTo: Use the PrintForm PrintPageComplete Event to Draw 'Rubber Stamp' Text on Top of the Printout </p>
		<p class="HowToPara"><span class="HowToSubHeading">ID: W3298004</span></p>
		<p class="HowToPara">&nbsp;</p>
		<p class="HowToPara"><span class="HowToSubHeading">Background</span> 
		    </p>
		<p class="HowToPara">The System.Drawing.Printing.PrintDocument class raises a PrintPage event to give you an opportunity to draw the content of the page, but PrintForm, which is derived from PrintDocument, draws its content on the page after the PrintPage event has fired, so if you want to draw on top of the page after all drawing has completed you must use the PrintForm.PrintPageComplete event.</p>
		<p class="HowToSubHeading">Drawing in the PrintPageComplete Event</p>
		<p class="HowToPara">Handle the PrintForm PrintPageComplete event and add the following code to draw rotated 'rubber stamp' style text on top of the page output. </p>
		<p class="HowToPara"><a href="W3298004.gif" target="_blank"><img src="W3298004_50pc.gif" width="313" height="359" border="0"></a></p>
		<p class="HowToPara">C# Code Sample: </p>
		<p class="HowToPara"> 				<span class="codefont">private void printForm1_PrintPageComplete(object sender, TMGDevelopment.Printing.PrintPageCompleteEventArgs e)<br>
{<br>
&nbsp;&nbsp;this.DrawTextRotated(&quot;Not Valid&quot;, e.Graphics, e.PageBounds, 315F, true);<br>
}</span></p>
		<p class="codefont"> private void DrawTextRotated(string text, Graphics graphics, Rectangle bounds, float rotation, bool hollow)<br>
          {<br>
&nbsp;&nbsp;// make sure no transformations we apply here affect subsequent graphics operations<br>
&nbsp;&nbsp;System.Drawing.Drawing2D.GraphicsContainer gc = graphics.BeginContainer();<br>
&nbsp;&nbsp;System.Drawing.Font f = new System.Drawing.Font(&quot;Arial&quot;, 100);<br>
&nbsp;&nbsp;System.Drawing.SizeF sizeText = graphics.MeasureString(text, f);<br>
&nbsp;&nbsp;// find centre of drawing rectangle<br>
&nbsp;&nbsp;System.Drawing.Point pointCentre = new System.Drawing.Point(bounds.Width / 2, bounds.Height / 2);<br>
&nbsp;&nbsp;graphics.TranslateTransform(pointCentre.X, pointCentre.Y);<br>
&nbsp;&nbsp;// rotate around centre point<br>
&nbsp;&nbsp;graphics.RotateTransform(rotation);<br>
&nbsp;&nbsp;// calc start point for text centered in bounding rect, based on text length<br>
&nbsp;&nbsp;System.Drawing.Point pointStart = new System.Drawing.Point(-(int)(sizeText.Width / 2), -(int)(sizeText.Height / 2));<br>
&nbsp;&nbsp;if (hollow)<br>
&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;// hollow text, draw as path outline<br>
&nbsp;&nbsp;&nbsp;&nbsp;System.Drawing.Drawing2D.GraphicsPath path = new System.Drawing.Drawing2D.GraphicsPath();<br>
&nbsp;&nbsp;&nbsp;&nbsp;float emSize = 100F * f.SizeInPoints / 72F;<br>
&nbsp;&nbsp;&nbsp;&nbsp;path.AddString(text, f.FontFamily, (int)f.Style, emSize, pointStart, StringFormat.GenericDefault);<br>
&nbsp;&nbsp;&nbsp;&nbsp;Pen pen = new Pen(Brushes.Gray, 2F);<br>
&nbsp;&nbsp;&nbsp;&nbsp;graphics.DrawPath(pen, path);<br>
&nbsp;&nbsp;&nbsp;&nbsp;pen.Dispose();<br>
&nbsp;&nbsp;&nbsp;&nbsp;path.Dispose();<br>
&nbsp;&nbsp;}<br>
&nbsp;&nbsp;else<br>
&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;// filled text<br>
&nbsp;&nbsp;&nbsp;&nbsp;graphics.DrawString(text, f, System.Drawing.Brushes.Gray, pointStart);<br>
&nbsp;&nbsp;}<br>
&nbsp;&nbsp;f.Dispose();<br>
&nbsp;&nbsp;// restore previous transforms etc<br>
&nbsp;&nbsp;graphics.EndContainer(gc);<br>
  }<br>
		  </p>
		<p class="HowToPara"><span class="codefont"><br>
            </span><br>
                </p>
		<p>&nbsp;</p>
		<p class="HowToSubHeading">&nbsp; </p>
		<p class="HowToPara">
		  Last updated 
		  <!-- #BeginDate format:En2 -->04-Aug-2019<!-- #EndDate -->
		</p>
		<!-- InstanceEndEditable -->		</td>
		</tr>
		</table>
  		</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
</body>
<script src="https://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-2162526-1";
urchinTracker();
</script>
<!-- InstanceEnd --></html>
